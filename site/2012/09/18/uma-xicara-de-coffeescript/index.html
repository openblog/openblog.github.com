<!doctype html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8" />
	
		<title>Uma xícara de CoffeeScript | Open Blog</title>
	
	
		<meta name="author" content="Almir Filho" />
	
	
		<meta name="keywords" content="coffeescript, javascript, documentacao, script, ruby, python, string, interpolacao, classe, class, list, compreenshion, compreensao, lista, prototype
" />
	
	
		<meta name="description" content="CoffeeScript é uma linda linguagem que traz o que há de melhor (sintaticamente falando) em outras linguagens como Python e Ruby, e pra completar, também é compilável para JavaScript." />
	
	<meta name="language" content="pt" />
	<meta name="content-language" content="pt-BR" />
	<meta name="robots" content="all" />
	<meta name="distribution" content="Global" />
	<meta name="resource-type" content="document" />

	<link rel="icon" type="image/png" href="/assets/img/favicon.png" />
    <link href="/assets/css/screen.css?2013-02-22" media="screen, projection" rel="stylesheet" type="text/css" />
    <!--[if IE]>
    	<link href="/assets/css/ie.css?2013-02-22" media="screen, projection" rel="stylesheet" type="text/css" />
  	<![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Ubuntu:300' rel='stylesheet' type='text/css'>
</head>

<body>

	<div id="wrapper">
		
		<header id="main">
	<h1><a href="/" id="logo">.openBlog()</a></h1>
</header>
		
		<section id="content">

			<section class="post-container" itemscope itemtype="http://schema.org/BlogPosting">
				<span class="hidden" itemprop="publisher">Open Blog</span>
				<article>
					<header>
						<h1><a href="/2012/09/18/uma-xicara-de-coffeescript/" itemprop="headline">Uma xícara de <span>CoffeeScript</span></a></h1>
					</header>
					<section itemprop="articleBody">
						
						<figure>
							<img itemprop="thumbnailUrl" src="/images/posts/2012-09-18-coffeescript.jpg" class="post-image" alt="Uma xícara de CoffeeScript" title="Uma xícara de CoffeeScript" width="700" height="432" />
						</figure>
						
						<p>Programador tem fama de gostar de café. Se você pertence a este distinto grupo e também gosta de JavaScript, então provavelmente gostará de <strong>CoffeeScript</strong>.</p>

<p>CoffeeScript é uma linda linguagem que traz o que há de melhor (sintaticamente falando) em outras linguagens como Python e Ruby, e pra completar, também é compilável para JavaScript.</p>

<p>O objetivo deste post é apenas apresentar uma breve introdução da linguagem e suas principais vantagens. Para uma completa referência de CoffeeScript – inclusive instruções de instalação –, recomendo que visite a documentação oficial, que recentemente traduzimos para o português: <a href='http://coffeescript.com.br' title='CoffeeScript BR'>coffeescript.com.br</a>.</p>

<h2 id='curiosidades'>Curiosidades</h2>

<ul>
<li>É a 11ª linguagem mais usada no GitHub no momento. Ultrapassou C# recentemente. <a href='https://github.com/languages/CoffeeScript'>GitHub Languages</a></li>

<li>O GitHub usa CoffeeScript em suas aplicações. <a href='https://github.com/styleguide/javascript'>GitHub Styleguide</a></li>

<li>É a linguagem de <em>front-end</em> padrão do Ruby on Rails.</li>

<li>O Dropbox recentemente <a href='https://tech.dropbox.com/?p=361' title='Dropbox dives into CoffeeScript'>reescreveu todo o seu <em>front-end</em> em CoffeeScript</a>, tendo uma economia de mais de <strong>5000 linhas</strong> de código.</li>
</ul>

<h2 id='adeus__e_s'>Adeus ; e {}&#8217;s</h2>

<p>Quem programa em Python ou Ruby, acaba detestando esse papo de ter que usar <code>;</code> ao final das linhas. Outra coisa que também é chata – e sintaticamente feia – é usar <code>{}</code> para delimitar blocos de comando, nesse caso, CoffeeScript apenas considera a indentação do código (assim como em Python).</p>

<h3 id='objetos'>Objetos</h3>

<p>Para definir um simples objeto, até o uso de <code>,</code> é opcional:</p>
<div class='highlight'><pre><code class='coffeescript'><span class='nv'>bandas =</span>
    <span class='nv'>rock:</span>
        <span class='nv'>nome: </span><span class='s'>&#39;Creedence Clearwater Revival&#39;</span>
        <span class='nv'>ano: </span><span class='mi'>1967</span>
    <span class='nv'>funk:</span>
        <span class='nv'>nome: </span><span class='nx'>James</span> <span class='nx'>Brown</span>
        <span class='nv'>ano: </span><span class='mi'>1956</span>
</code></pre></div>
<p>Mas se você quiser declarar tudo em uma única linha, deve-se utilizar <code>,</code> normalmente. O JavaScript equivalente ao código acima é:</p>
<div class='highlight'><pre><code class='javascript'><span class='nx'>bandas</span> <span class='o'>=</span> <span class='p'>{</span>
    <span class='nx'>rock</span><span class='o'>:</span> <span class='p'>{</span>
        <span class='nx'>nome</span><span class='o'>:</span> <span class='s1'>&#39;Creedence Clearwater Revival&#39;</span><span class='p'>,</span>
        <span class='nx'>ano</span><span class='o'>:</span> <span class='mi'>1967</span>
    <span class='p'>},</span>
    <span class='nx'>funk</span><span class='o'>:</span> <span class='p'>{</span>
        <span class='nx'>nome</span><span class='o'>:</span> <span class='nx'>James</span> <span class='nx'>Brown</span><span class='p'>,</span>
        <span class='nx'>ano</span><span class='o'>:</span> <span class='mi'>1956</span>
    <span class='p'>}</span>
<span class='p'>};</span>
</code></pre></div>
<h2 id='interpolao_de_strings'>Interpolação de strings</h2>

<p>JavaScript não tem interpolação de strings, então CoffeeScript nos traz esse recurso super útil no estilo de Ruby, usando <code>#{}</code> dentro da <em>string</em>:</p>
<div class='highlight'><pre><code class='coffeescript'><span class='nv'>numero = </span><span class='mi'>42</span>
<span class='nv'>string = </span><span class='s'>&quot;O número </span><span class='si'>#{</span> <span class='nx'>numero</span> <span class='si'>}</span><span class='s'> dividido por 3 é </span><span class='si'>#{</span> <span class='nx'>numero</span> <span class='o'>/</span> <span class='mi'>3</span> <span class='si'>}</span><span class='s'>.&quot;</span>
</code></pre></div>
<p>Em JavaScript, precisaríamos realizar a concatenação de <em>strings</em>:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>numero</span><span class='p'>,</span> <span class='nx'>string</span><span class='p'>;</span>
<span class='nx'>numero</span> <span class='o'>=</span> <span class='mi'>42</span><span class='p'>;</span>
<span class='nx'>string</span> <span class='o'>=</span> <span class='s2'>&quot;O número &quot;</span> <span class='o'>+</span> <span class='nx'>numero</span> <span class='o'>+</span> <span class='s2'>&quot; dividido por 3 é &quot;</span> <span class='o'>+</span> <span class='p'>(</span><span class='nx'>numero</span> <span class='o'>/</span> <span class='mi'>3</span><span class='p'>)</span> <span class='o'>+</span> <span class='s2'>&quot;.&quot;</span><span class='p'>;</span>
</code></pre></div>
<h2 id='intervalos'>Intervalos</h2>

<p>Os intervalos (<em>ranges</em>) são expressões que retornam <em>arrays</em> com números sequenciais. Podemos utilizar intervalos para fazer iterações e fatiar (<em>slice</em>) <em>arrays</em>:</p>
<div class='highlight'><pre><code class='coffeescript'><span class='c1'># definindo intervalos</span>
<span class='nv'>sequenciaCrescente   = </span><span class='p'>[</span><span class='mi'>0</span><span class='p'>..</span><span class='mi'>10</span><span class='p'>]</span> <span class='c1'># com .. inclui o último índice</span>
<span class='nv'>sequenciaDecrescente = </span><span class='p'>[</span><span class='mi'>7</span><span class='p'>...</span><span class='mi'>3</span><span class='p'>]</span> <span class='c1'># com ... exclui o último índice</span>

<span class='nv'>bebidas = </span><span class='p'>[</span> <span class='s'>&#39;jack daniel’s&#39;</span><span class='p'>,</span> <span class='s'>&#39;heineken&#39;</span><span class='p'>,</span> <span class='s'>&#39;stella artois&#39;</span><span class='p'>,</span> <span class='s'>&#39;martini&#39;</span><span class='p'>,</span> <span class='s'>&#39;smirnoff ice&#39;</span> <span class='p'>]</span>

<span class='c1'># fatiamento de array</span>
<span class='nv'>bebidasDeMacho  = </span><span class='nx'>bebidas</span><span class='p'>[</span><span class='mi'>0</span><span class='p'>..</span><span class='mi'>1</span><span class='p'>]</span>
<span class='nv'>bebidasDeMenina = </span><span class='nx'>bebidas</span><span class='p'>[</span><span class='mi'>2</span><span class='p'>..</span><span class='mi'>4</span><span class='p'>]</span>
</code></pre></div>
<p>O <em>script</em> acima gera a seguinte saída em JavaScript:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>sequencia</span><span class='p'>,</span> <span class='nx'>bebidas</span><span class='p'>,</span> <span class='nx'>bebidasDeMacho</span><span class='p'>,</span> <span class='nx'>bebidasDeMenina</span><span class='p'>;</span>

<span class='nx'>sequenciaCrescente</span>   <span class='o'>=</span> <span class='p'>[</span><span class='mi'>0</span><span class='p'>,</span> <span class='mi'>1</span><span class='p'>,</span> <span class='mi'>2</span><span class='p'>,</span> <span class='mi'>3</span><span class='p'>,</span> <span class='mi'>4</span><span class='p'>,</span> <span class='mi'>5</span><span class='p'>,</span> <span class='mi'>6</span><span class='p'>,</span> <span class='mi'>7</span><span class='p'>,</span> <span class='mi'>8</span><span class='p'>,</span> <span class='mi'>9</span><span class='p'>,</span> <span class='mi'>10</span><span class='p'>];</span>
<span class='nx'>sequenciaDecrescente</span> <span class='o'>=</span> <span class='p'>[</span><span class='mi'>7</span><span class='p'>,</span> <span class='mi'>6</span><span class='p'>,</span> <span class='mi'>5</span><span class='p'>,</span> <span class='mi'>4</span><span class='p'>];</span>

<span class='nx'>bebidas</span> <span class='o'>=</span> <span class='p'>[</span> <span class='s1'>&#39;jack daniel’s&#39;</span><span class='p'>,</span> <span class='s1'>&#39;heineken&#39;</span><span class='p'>,</span> <span class='s1'>&#39;stella artois&#39;</span><span class='p'>,</span> <span class='s1'>&#39;martini&#39;</span><span class='p'>,</span> <span class='s1'>&#39;smirnoff ice&#39;</span> <span class='p'>];</span>

<span class='nx'>bebidasDeMacho</span>  <span class='o'>=</span> <span class='nx'>bebidas</span><span class='p'>.</span><span class='nx'>slice</span><span class='p'>(</span><span class='mi'>0</span><span class='p'>,</span> <span class='mi'>2</span><span class='p'>);</span>
<span class='nx'>bebidasDeMenina</span> <span class='o'>=</span> <span class='nx'>bebidas</span><span class='p'>.</span><span class='nx'>slice</span><span class='p'>(</span><span class='mi'>2</span><span class='p'>,</span> <span class='mi'>5</span><span class='p'>);</span>
</code></pre></div>
<h2 id='compreenses_de_lista'>Compreensões de lista</h2>

<p>Outra coisa trazida de Python, compreensões de lista são uma mão na roda. São expressões que executam determinadas ações em <em>arrays</em>, objetos e intervalos, e ainda retornam valores. Por exemplo, vamos percorrer um objeto e retornar <em>strings</em>:</p>
<div class='highlight'><pre><code class='coffeescript'><span class='nv'>nirvana =</span>
    <span class='nv'>vocalista: </span><span class='s'>&#39;Kurt Cobain&#39;</span>
    <span class='nv'>baixista: </span><span class='s'>&#39;Krist Novoselic&#39;</span>
    <span class='nv'>baterista: </span><span class='s'>&#39;Dave Grohl&#39;</span>

<span class='c1'># iterando sobre chaves/valores do objeto</span>
<span class='nv'>funcoes = </span><span class='k'>for</span> <span class='nx'>funcao</span><span class='p'>,</span> <span class='nx'>integrante</span> <span class='k'>of</span> <span class='nx'>nirvana</span>
    <span class='s'>&quot;</span><span class='si'>#{</span><span class='nx'>integrante</span><span class='si'>}</span><span class='s'> é </span><span class='si'>#{</span><span class='nx'>funcao</span><span class='si'>}</span><span class='s'>&quot;</span>
</code></pre></div>
<p>Perceba a diferença (quantidade de linhas e legibilidade) entre essas últimas 2 linhas do código acima e as 9 últimas linhas de JavaScript geradas abaixo:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>funcao</span><span class='p'>,</span> <span class='nx'>funcoes</span><span class='p'>,</span> <span class='nx'>integrante</span><span class='p'>,</span> <span class='nx'>nirvana</span><span class='p'>;</span>

<span class='nx'>nirvana</span> <span class='o'>=</span> <span class='p'>{</span>
    <span class='nx'>vocalista</span><span class='o'>:</span> <span class='s1'>&#39;Kurt Cobain&#39;</span><span class='p'>,</span>
    <span class='nx'>baixista</span><span class='o'>:</span> <span class='s1'>&#39;Krist Novoselic&#39;</span><span class='p'>,</span>
    <span class='nx'>baterista</span><span class='o'>:</span> <span class='s1'>&#39;Dave Grohl&#39;</span>
<span class='p'>};</span>

<span class='nx'>funcoes</span> <span class='o'>=</span> <span class='p'>(</span><span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span>
    <span class='kd'>var</span> <span class='nx'>_results</span><span class='p'>;</span>
    <span class='nx'>_results</span> <span class='o'>=</span> <span class='p'>[];</span>
    <span class='k'>for</span> <span class='p'>(</span><span class='nx'>funcao</span> <span class='k'>in</span> <span class='nx'>nirvana</span><span class='p'>)</span> <span class='p'>{</span>
      <span class='nx'>age</span> <span class='o'>=</span> <span class='nx'>yearsOld</span><span class='p'>[</span><span class='nx'>funcao</span><span class='p'>];</span>
      <span class='nx'>_results</span><span class='p'>.</span><span class='nx'>push</span><span class='p'>(</span><span class='s2'>&quot;&quot;</span> <span class='o'>+</span> <span class='nx'>integrante</span> <span class='o'>+</span> <span class='s2'>&quot; é &quot;</span> <span class='o'>+</span> <span class='nx'>funcao</span><span class='p'>);</span>
    <span class='p'>}</span>
    <span class='k'>return</span> <span class='nx'>_results</span><span class='p'>;</span>
<span class='p'>})();</span>
</code></pre></div>
<p>Para fazer um <code>for</code> clássico, simplesmente utilizamos os <a href='#intervalos'>intervalos</a>. Podemos basicamente fazer de duas maneiras:</p>
<div class='highlight'><pre><code class='coffeescript'><span class='c1'># forma mais clássica</span>
<span class='k'>for</span> <span class='nx'>numero</span> <span class='k'>in</span> <span class='p'>[</span><span class='mi'>0</span><span class='p'>...</span><span class='mi'>5</span><span class='p'>]</span>
    <span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span> <span class='nx'>numero</span>

<span class='c1'># forma mais elegante</span>
<span class='nx'>console</span><span class='p'>.</span><span class='nx'>log</span> <span class='nx'>numero</span> <span class='k'>for</span> <span class='nx'>numero</span> <span class='k'>in</span> <span class='p'>[</span><span class='mi'>0</span><span class='p'>...</span><span class='mi'>5</span><span class='p'>]</span>
</code></pre></div>
<h2 id='operador_existencial'>Operador existencial</h2>

<p>Verificar a existência de variáveis em JavaScript é um pouco chato, pois precisa-se efetuar 2 testes. CoffeeScript tem um operador <code>?</code> que torna essa tarefa muito simples:</p>
<div class='highlight'><pre><code class='coffeescript'><span class='nv'>rockBand = </span><span class='kc'>true</span> <span class='k'>if</span> <span class='nx'>guitarra</span><span class='o'>?</span> <span class='o'>and</span> <span class='o'>not</span> <span class='nx'>sertanejoUniversitario</span><span class='o'>?</span>
</code></pre></div>
<p><code>rockBand</code> será verdadeiro se existir <code>guitarra</code> e se não existir <code>sertanejoUniversitario</code>. A seguir, o JavaScript equivalente:</p>
<div class='highlight'><pre><code class='javascript'><span class='kd'>var</span> <span class='nx'>rockBand</span><span class='p'>;</span>

<span class='k'>if</span> <span class='p'>((</span><span class='k'>typeof</span> <span class='nx'>guitarra</span> <span class='o'>!==</span> <span class='s2'>&quot;undefined&quot;</span> <span class='o'>&amp;&amp;</span> <span class='nx'>guitarra</span> <span class='o'>!==</span> <span class='kc'>null</span><span class='p'>)</span> <span class='o'>&amp;&amp;</span> <span class='o'>!</span><span class='p'>(</span><span class='k'>typeof</span> <span class='nx'>sertanejoUniversitario</span> <span class='o'>!==</span> <span class='s2'>&quot;undefined&quot;</span> <span class='o'>&amp;&amp;</span> <span class='nx'>sertanejoUniversitario</span> <span class='o'>!==</span> <span class='kc'>null</span><span class='p'>))</span> <span class='p'>{</span>
    <span class='nx'>rockBand</span> <span class='o'>=</span> <span class='kc'>true</span><span class='p'>;</span>
<span class='p'>}</span>
</code></pre></div>
<h2 id='classes'>Classes</h2>

<p>Taí uma coisa que qualquer programador OO sente bastante falta em JavaScript: declarações de classes de maneira mais clara. Isso ocorre porque JavaScript é uma linguagem orientada a protótipos, e trabalhar com prototipação e herança prototipada é um pouco confuso pra quem vem da orientação à objetos. CoffeeScript oferece uma maneira simples de definição de classes e herança, inclusive com construtores mais simples.</p>
<div class='highlight'><pre><code class='coffeescript'><span class='k'>class</span> <span class='nx'>Animal</span>
  <span class='nv'>constructor: </span><span class='nf'>(@nome) -&gt;</span>

  <span class='nv'>mover: </span><span class='nf'>(metros) -&gt;</span>
    <span class='nx'>alert</span> <span class='nx'>@nome</span> <span class='o'>+</span> <span class='s'>&quot; moveu-se </span><span class='si'>#{</span><span class='nx'>metros</span><span class='si'>}</span><span class='s'>m.&quot;</span>

<span class='k'>class</span> <span class='nx'>Cachorro</span> <span class='k'>extends</span> <span class='nx'>Animal</span>
  <span class='nv'>mover: </span><span class='nf'>-&gt;</span>
    <span class='nx'>alert</span> <span class='s'>&quot;Au au!&quot;</span>
    <span class='k'>super</span> <span class='mi'>5</span>

<span class='k'>class</span> <span class='nx'>Gato</span> <span class='k'>extends</span> <span class='nx'>Animal</span>
  <span class='nv'>mover: </span><span class='nf'>-&gt;</span>
    <span class='nx'>alert</span> <span class='s'>&quot;Miau!&quot;</span>
    <span class='k'>super</span> <span class='mi'>45</span>

<span class='nv'>toto = </span><span class='k'>new</span> <span class='nx'>Cachorro</span> <span class='s'>&quot;Totó, o cachorro&quot;</span>
<span class='nv'>tom  = </span><span class='k'>new</span> <span class='nx'>Gato</span> <span class='s'>&quot;Tom, o gato&quot;</span>

<span class='nx'>toto</span><span class='p'>.</span><span class='nx'>mover</span><span class='p'>()</span>
<span class='nx'>tom</span><span class='p'>.</span><span class='nx'>mover</span><span class='p'>()</span>
</code></pre></div>
<p>Quer adicionar propriedades ou métodos à sua classe (protótipo) em tempo de execução?</p>
<div class='highlight'><pre><code class='coffeescript'><span class='nv'>Animal::morrer = </span><span class='nf'>-&gt;</span>
  <span class='nx'>alert</span> <span class='s'>&quot;</span><span class='si'>#{</span><span class='nx'>@nome</span><span class='si'>}</span><span class='s'> morreu =(&quot;</span>
</code></pre></div>
<p>Eu poderia continuar falando das <strong>N</strong> coisas legais de CoffeeScript – como herança, funções, <em>splats</em>, atribuições de troca, <em>switchs</em>, comparações em cadeia, etc –, mas simplesmente não há necessidade, visto que temos um ótimo e completo guia da linguagem aqui: <a href='http://coffeescript.com.br' title='CoffeeScript BR'>coffeescript.com.br</a>.</p>

<h2 id='por_enquanto__isso'>Por enquanto é isso</h2>
<figure>
    <img alt='Haters Gonna Hate' height='200' src='/images/posts/2012-09-18-haters-gonna-hate.jpg' title='Haters Gonna Hate' width='700' />
</figure>
<p>CoffeeScript é um assunto muito polêmico. Eis um <a href='https://github.com/rails/rails/compare/9333ca7...23aa7da'>link que achei bem engraçado</a>, trata-se da discussão sobre o <em>commit</em> que adiciona o CoffeeScript como padrão no Ruby on Rails. Salientando que esse foi um dos <em>commits</em> mais polêmicos da <strong>história do GitHub</strong>. Vale dar uma olhada, os nerds se atracaram num grande bate boca com imagens bastante divertidas.</p>
<aside class='fonte'>
    <h3>Referência</h3>
    <ul>
        <li>→<a alt='CoffeeScript em português' href='http://coffeescript.com.br' title='CoffeeScript em português'>CoffeeScript: documentação em português</a></li>
        <li>→<a alt='CoffeeScript' href='http://coffeescript.org' title='CoffeeScript'>CoffeeScript: documentação em inglês</a></li>
    </ul>
</aside>
					</section>
				</article>
			</section>

		</section><!-- end #content -->

	</div><!-- end #wrapper -->

</body>
</html>
