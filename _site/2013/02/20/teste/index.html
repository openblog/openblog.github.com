<!doctype html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8" />
	
		<title>Last Teste | Open Blog</title>
	
	
		<meta name="author" content="Vagner Santana" />
	
	
		<meta name="keywords" content="html5, javascript
" />
	
	
		<meta name="description" content="Mais uma API simples e útil do HTML5. Com ela temos acesso, de forma nativa, ao status da conexão do navegador, ou seja, se ele tem acesso ou não à rede." />
	
	<meta name="language" content="pt" />
	<meta name="content-language" content="pt-BR" />
	<meta name="robots" content="all" />
	<meta name="distribution" content="Global" />
	<meta name="resource-type" content="document" />

	<link rel="icon" type="image/png" href="/assets/img/favicon.png" />
    <link href="/assets/css/style.css?2013-02-24" media="screen, projection" rel="stylesheet" type="text/css" />
    <!--[if IE]>
    	<link href="/assets/css/ie.css?2013-02-24" media="screen, projection" rel="stylesheet" type="text/css" />
  	<![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Ubuntu:300' rel='stylesheet' type='text/css'>
</head>

<body>

	<div id="wrapper">
		
		<header id="main">
	<h1><a href="/" id="logo">.openBlog()</a></h1>
</header>
		
		<section id="content">

			<section class="post-container" itemscope itemtype="http://schema.org/BlogPosting">
				<span class="hidden" itemprop="publisher">Open Blog</span>
				<aside class="post-meta">
					<ul>
						<li class="post-data">
							<span class="icon-aside"></span>
							<time itemprop="datePublished" datetime="2013-02-20">20/02/2013</time>
						</li>
						<li class="post-autor">
							<span class="icon-aside"></span>
							<a href="https://plus.google.com/" data-link="http://twitter.com/vagnervjs" title="Vagner Santana" alt="Vagner Santana" rel="author" itemprop="author" onclick="_gaq.push(['_trackEvent', 'post_author', 'Post View', 'Vagner Santana'])">Vagner Santana</a>
						</li>
						
						<li class="post-comentarios">
							<span class="icon-aside"></span>
							<a href="/2013/02/20/teste/#disqus_thread" data-disqus-identifier="/2013/02/20/teste" itemprop="interactionCount" onclick="_gaq.push(['_trackEvent', 'post_comments', 'Post View', ''])">Carregando...</a>
						</li>
						
						
						<li class="post-tags">
							<span class="icon-aside"></span>
							<ul>
								
								<li><a href="/tag/HTML5"><span>#</span>HTML5</a></li>,
								
								<li><a href="/tag/javascript"><span>#</span>javascript</a></li>
								
							</ul>
							
							<span class="hidden" itemprop="keywords">html5, javascript
</span>
							
						</li>
						
					</ul>
				</aside>
				<article>
					<header>
						<h1><a href="/2013/02/20/teste/" itemprop="headline">Last Teste</a></h1>
					</header>
					<section itemprop="articleBody">
						
						<figure>
							<img itemprop="thumbnailUrl" src="/img/posts/test.jpg" class="post-image" alt="Last Teste" title="Last Teste" width="700" height="432" />
						</figure>
						
						<p>Mais uma <abbr title='Application Program Interface'>API</abbr> simples e útil do <abbr title='HyperText Markup Language 5'>HTML5</abbr>. Com ela temos acesso, de forma nativa, ao <strong>status da conexão do navegador</strong>, ou seja, se ele tem acesso ou não à rede. Não confundir com acesso à internet, já que é possível estarmos conectados em uma rede local sem acesso externo à internet.</p>

<h2 id='api'>API</h2>

<p>A <abbr title='Application Program Interface'>API</abbr> é bem direta ao ponto. Basta adicionarmos <em>listeners</em> aos objetos <code>window</code>, <code>document</code> ou ao elemento <code>body</code> e passarmos a função que será executada uma vez que esses eventos forem disparados. O evento irá, na verdade, acontecer no elemento <code>body</code>, mas irá propagar até o objeto <code>window</code>, passando por <code>document</code>. Por isso podemos por o <em>listener</em> em qualquer um.</p>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// javascript puro</span>
<span class='nb'>window</span><span class='p'>.</span><span class='nx'>addEventListener</span><span class='p'>(</span><span class='s1'>&#39;online&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span>
  <span class='c1'>// ...</span>
<span class='p'>})</span>
<span class='nb'>window</span><span class='p'>.</span><span class='nx'>addEventListener</span><span class='p'>(</span><span class='s1'>&#39;offline&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span>
  <span class='c1'>// ...</span>
<span class='p'>})</span>
</code></pre></div>
<p>No exemplo acima estamos escutando o evento através de JavaScript puro. No exemplo abaixo estamos usando jQuery. O método <code>on</code> é agora o método padrão para escutar eventos no jQuery, inclusive para os eventos clássicos como <code>click</code>, <code>hover</code>, etc. Os dois códigos são equivalentes.</p>
<div class='highlight'><pre><code class='javascript'><span class='c1'>// jQuery style</span>
<span class='nx'>$</span><span class='p'>(</span><span class='nb'>window</span><span class='p'>)</span>
  <span class='p'>.</span><span class='nx'>on</span><span class='p'>(</span><span class='s1'>&#39;online&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span>
    <span class='c1'>// ...</span>
  <span class='p'>})</span>
  <span class='p'>.</span><span class='nx'>on</span><span class='p'>(</span><span class='s1'>&#39;offline&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span>
    <span class='c1'>// ...</span>
  <span class='p'>})</span>
</code></pre></div>
<h2 id='propriedade_online'>Propriedade online</h2>

<p>Também é possível detectar se o navegador está <em>online</em> de forma síncrona. Basta checar a propriedade <code>navigator.onLine</code>. Se ela retornar <code>true</code>, significa que estamos com conexão à rede, se retornar <code>false</code>&#8230;vocês entenderam.</p>
<div class='highlight'><pre><code class='javascript'><span class='k'>if</span> <span class='p'>(</span><span class='nx'>navigator</span><span class='p'>.</span><span class='nx'>onLine</span><span class='p'>)</span> <span class='p'>{</span>
  <span class='c1'>// está online</span>
<span class='p'>}</span> <span class='k'>else</span> <span class='p'>{</span>
  <span class='c1'>// está offline</span>
<span class='p'>}</span>
</code></pre></div>
<h2 id='demo'>Demo</h2>

<p>O que melhor que um exemplo para demonstrar a nova <abbr title='Application Program Interface'>API</abbr>? Caso esteja usando o Chrome, Safari ou Internet Explorer, <strong>desconecte a sua máquina da rede desligando o <em>Wi-Fi</em></strong> ou desplugando o cabo <em>ethernet</em> para então ver uma animação informando que a conexão foi perdida. Caso esteja no Firefox, vá no menu <em>File</em> &gt; <em>Work Offline</em> para que o evento <em>offline</em> seja disparado. Conecte de novo e, quando a conexão retornar, o aviso irá sumir. Simples e lindo, hein?</p>

<h2 id='suporte_e_inconsistncias'>Suporte e Inconsistências</h2>

<p>Cada navegador interpreta o termo <em>offline</em> de maneiradiferente. A especificação do <abbr title='HyperText Markup Language 5'>HTML5</abbr> informa que o evento <em>offline</em> deve ser disparado quando o computador perder conexão com a rede, e não necessariamente com a internet.</p>
<blockquote>
  <p>
    Returns false if the user agent is definitely offline (disconnected from
    the network). Returns true if the user agent might be online. The events
    online and offline are fired when the value of this attribute changes.
  </p>
  <footer>
    – <abbr title='Web Hypertext Application Technology Working Group'>WHATWG</abbr>
    Browser state spec
  </footer>
</blockquote>
					</section>
					
					<footer id="disqus_thread">
						<noscript>Por favor, habilite JavaScript para ver os comentários. <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
					</footer>
					
				</article>
			</section>

		</section><!-- end #content -->

	</div><!-- end #wrapper -->
	
	<script>

	    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	    var disqus_shortname = 'opblog'; // required: replace example with your forum shortname
	    var disqus_identifier = '/2013/02/20/teste';
	    // var disqus_developer = 1;

	    // callback do Disqus
	    function disqus_callback() {
	    	// modifica o título da caixa de comentários
	    	$('#dsq-reply h3').html('Comentários')
	    }

	    /* * * DON'T EDIT BELOW THIS LINE * * */
	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

	        // comment count
	        var s = document.createElement('script'); s.async = true;
	        s.type = 'text/javascript';
	        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
	        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
	    })();

	</script>
	

</body>
</html>
